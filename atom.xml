<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://m365tech.ca</id>
    <title>M365 Tech Blog Blog</title>
    <updated>2024-09-08T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://m365tech.ca"/>
    <subtitle>M365 Tech Blog Blog</subtitle>
    <icon>https://m365tech.ca/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Changes in PnP Management Shell registration in Microsoft 365]]></title>
        <id>https://m365tech.ca/changes-pnp-management-shell-registration</id>
        <link href="https://m365tech.ca/changes-pnp-management-shell-registration"/>
        <updated>2024-09-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[What is happening on Sept 9th, 2024]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-happening-on-sept-9th-2024">What is happening on Sept 9th, 2024<a class="hash-link" aria-label="Direct link to What is happening on Sept 9th, 2024" title="Direct link to What is happening on Sept 9th, 2024" href="https://m365tech.ca/changes-pnp-management-shell-registration#what-is-happening-on-sept-9th-2024">​</a></h2>
<p>As announced by the <a href="https://pnp.github.io/blog/post/changes-pnp-management-shell-registration" target="_blank" rel="noopener noreferrer">PnP Powershell Team</a>, the multi-tenant app registration will be deleted on September 9th, 2024. For those who are not familiar what this application looks like in your tenant, here is a screenshot:</p>
<p><img decoding="async" loading="lazy" alt="Multi Tenant App Registration" src="https://m365tech.ca/assets/images/multi-tenant-app-c745357effa59d3d3956362c94192ad2.jpg" width="1837" height="1216" class="img_ev3q"></p>
<p>As quoted:</p>
<blockquote>
<p>This change is provided to help customers to improve their security posture by encouraging the use of single tenant app registrations with on just the scopes and permissions which are needed.</p>
<p>-- PnP PowerShell Team</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="multi-tenant-app-registration">Multi-Tenant App Registration<a class="hash-link" aria-label="Direct link to Multi-Tenant App Registration" title="Direct link to Multi-Tenant App Registration" href="https://m365tech.ca/changes-pnp-management-shell-registration#multi-tenant-app-registration">​</a></h2>
<p>The Multi-Tenant App Registration was created by the PnP PowerShell Team in order to provide a quick way for M365 tenants to utilize the PnP.PowerShell modules and connect to desired tenants. It can be downloaded and installed by M365 customers to provide scripting capabilities for their admins/users. This application provides <a href="https://learn.microsoft.com/en-us/entra/identity-platform/delegated-access-primer" target="_blank" rel="noopener noreferrer">DELEGATED access</a> to the sites the user has access to.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Multi-Tenant App Registration has a set of <a href="https://m365tech.ca/changes-pnp-management-shell-registration#multi-tenant-app-permissions">default permissions</a> which cannot be altered once installed. This is probably, in my opinion, the reason they are eliminating this app.</p></div></div>
<p>Once connected to the tenant, you will be able to utilize the <a href="https://pnp.github.io/powershell/cmdlets/index.html" target="_blank" rel="noopener noreferrer">PnP cmdlets</a> depending on your current access to the site.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-interactive">-Interactive<a class="hash-link" aria-label="Direct link to -Interactive" title="Direct link to -Interactive" href="https://m365tech.ca/changes-pnp-management-shell-registration#-interactive">​</a></h3>
<p>This is the old way of connecting to sites. If you only provide the -Interactive parameter, you are explicitly saying the command to use the multi-tenant app registration to connect.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>This line of code will be unusable after the changes on Sept 9th</p></div></div>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Connect-PnPOnline</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(12, 150, 155)">[tenant]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">sharepoint</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">com </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Interactive</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-your-own-app-registration">Using your own App Registration<a class="hash-link" aria-label="Direct link to Using your own App Registration" title="Direct link to Using your own App Registration" href="https://m365tech.ca/changes-pnp-management-shell-registration#using-your-own-app-registration">​</a></h2>
<p>To replace the Multi-Tenant App Registration provided by the PnP PowerShell team, customers must now create a new Application Registration to be able to utilize the PnP PowerShell Module. Admins will now be able to scope what particular permissions should be allowed when using the module.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-app-registration">Creating an App Registration<a class="hash-link" aria-label="Direct link to Creating an App Registration" title="Direct link to Creating an App Registration" href="https://m365tech.ca/changes-pnp-management-shell-registration#creating-an-app-registration">​</a></h3>
<ol>
<li>Navigate to your <strong><a href="https://aad.cmd.ms/" target="_blank" rel="noopener noreferrer">Entra Admin Portal</a></strong></li>
<li>Click on <strong>Applications</strong> &gt; <strong>App Registrations</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="App Reg" src="data:image/jpeg;base64,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" width="273" height="137" class="img_ev3q"></p>
<ol start="3">
<li>Click on <strong>New Registration</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="New App Reg" src="https://m365tech.ca/assets/images/new-app-reg-36947c6fb6be1051b89f4076dd5e8de3.jpg" width="437" height="132" class="img_ev3q"></p>
<ol start="4">
<li>Fill out the <strong>Name</strong>. On the Redirect URI, Select <strong>Public client/native (mobile &amp; desktop)</strong>, and then type in <strong>"<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost</a>"</strong>. Hit <strong>Register</strong> at the bottom of the page.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Register App" src="https://m365tech.ca/assets/images/register-app-ba837525515397c37e1417c05ad21654.jpg" width="891" height="871" class="img_ev3q"></p>
<ol start="5">
<li>Once created, copy the application id and save it for future reference.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="App Created" src="https://m365tech.ca/assets/images/copy-app-id-c44cd9660ec9b357d6aa69857ea74f30.jpg" width="839" height="470" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-permissions">Adding Permissions<a class="hash-link" aria-label="Direct link to Adding Permissions" title="Direct link to Adding Permissions" href="https://m365tech.ca/changes-pnp-management-shell-registration#adding-permissions">​</a></h3>
<ol>
<li>Navigate to <strong>API Permissions</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="API Permissions" src="https://m365tech.ca/assets/images/api-permissions-968b26fa7092ca00d923c255f81be2fd.jpg" width="886" height="584" class="img_ev3q"></p>
<ol start="2">
<li>Click on <strong>Add Permission</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="Add Permission" src="https://m365tech.ca/assets/images/add-permission-fc468354110b398f4af8f1df0c609b4e.jpg" width="389" height="163" class="img_ev3q"></p>
<ol start="3">
<li>Find and click <strong>SharePoint</strong> (We will add SharePoint just for demo). We can also replicate the <a href="https://m365tech.ca/changes-pnp-management-shell-registration#multi-tenant-app-permissions">Multi-Tenant App Permissions</a> afterwards.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Add SharePoint" src="data:image/jpeg;base64,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" width="262" height="163" class="img_ev3q"></p>
<ol start="4">
<li>Select <strong>Delegated Permissions</strong></li>
</ol>
<p><img decoding="async" loading="lazy" alt="Delegated Permission" src="https://m365tech.ca/assets/images/select-delegated-9a04bc085a7f100312fd24fc57053403.jpg" width="841" height="377" class="img_ev3q"></p>
<ol start="5">
<li>Find and Check on <strong>AllSites.FullControl</strong>. Hit <strong>Add Permissions</strong>.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Select All Sites" src="https://m365tech.ca/assets/images/select-allsites-cdc52a6029f1f7d3df6731675e7c7053.jpg" width="790" height="367" class="img_ev3q"></p>
<ol start="6">
<li>Click on <strong>Grant admin consent for [environment name]</strong>. Hit <strong>Yes</strong> to the prompt.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Grant Consent" src="https://m365tech.ca/assets/images/grant-consent-cc85f003c7b09ab8e48d55566768f454.jpg" width="1043" height="310" class="img_ev3q">
<img decoding="async" loading="lazy" alt="Yes Grant Consent" src="https://m365tech.ca/assets/images/yes-grant-consent-409df575717d35908942c297d170478c.jpg" width="769" height="140" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-the-newly-created-app-registration">Use the newly created App Registration<a class="hash-link" aria-label="Direct link to Use the newly created App Registration" title="Direct link to Use the newly created App Registration" href="https://m365tech.ca/changes-pnp-management-shell-registration#use-the-newly-created-app-registration">​</a></h3>
<p>Once the application is created, users can now use the line below to connect to tenants. <strong>-ClientId</strong> specifies that user is connecting using the newly registered application.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Connect-PnPOnline</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(12, 150, 155)">[tenant]</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">sharepoint</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">com </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Interactive </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">ClientId </span><span class="token namespace" style="color:rgb(12, 150, 155)">[ApplicationID]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Successful Connection" src="https://m365tech.ca/assets/images/connect-success-fb4efd955785a192fcc297326f70a8b0.jpg" width="845" height="446" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="multi-tenant-app-permissions">Multi-Tenant App Permissions<a class="hash-link" aria-label="Direct link to Multi-Tenant App Permissions" title="Direct link to Multi-Tenant App Permissions" href="https://m365tech.ca/changes-pnp-management-shell-registration#multi-tenant-app-permissions">​</a></h2>
<p>For reference, here is the list of old permissions granted to the app.
<img decoding="async" loading="lazy" alt="Old Permissions 1" src="https://m365tech.ca/assets/images/old-permissions-1-257c149994cfec76f21a9e7e5c2512ac.jpg" width="1893" height="1025" class="img_ev3q">
<img decoding="async" loading="lazy" alt="Old Permissions 2" src="https://m365tech.ca/assets/images/old-permissions-2-bc3c18adee7b8eeab3adf7e0b61fb89e.jpg" width="1830" height="1022" class="img_ev3q">
<img decoding="async" loading="lazy" alt="Old Permissions 3" src="https://m365tech.ca/assets/images/old-permissions-3-c690b8701f7ac21b68985ac7def8c61e.jpg" width="1828" height="922" class="img_ev3q">
<img decoding="async" loading="lazy" alt="Old Permissions 4" src="https://m365tech.ca/assets/images/old-permissions-4-c1d8d69af257f18945fea63778de8020.jpg" width="1786" height="626" class="img_ev3q"></p>]]></content>
        <author>
            <name>Mark Doria</name>
            <uri>https://github.com/m365-tech</uri>
        </author>
        <category label="M365" term="M365"/>
        <category label="PnP PowerShell" term="PnP PowerShell"/>
        <category label="SharePoint" term="SharePoint"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Bulk change the owner of Power Automate flows using PowerShell]]></title>
        <id>https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell</id>
        <link href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell"/>
        <updated>2024-07-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[One of the operational task that many M365 admins is to maintain a current inventory of all Power Automate flows living inside their tenants. The real problem though is everytime a tenant user creates a new flow, tenant admins doesn't have the direct access to view/modify those flows. And if that particular user leaves the company there would be an unmonitored flow that may break without anyone being notified.]]></summary>
        <content type="html"><![CDATA[<p>One of the operational task that many M365 admins is to maintain a current inventory of all Power Automate flows living inside their tenants. The real problem though is everytime a tenant user creates a new flow, tenant admins doesn't have the direct access to view/modify those flows. And if that particular user leaves the company there would be an unmonitored flow that may break without anyone being notified.</p>
<p>In this post, we will discuss how to add/change the Power Automate Owners using powershell.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-requisites">Pre-requisites<a class="hash-link" aria-label="Direct link to Pre-requisites" title="Direct link to Pre-requisites" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#pre-requisites">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>At a minimum, <strong>Power Platform Admin</strong> role is needed to execute the steps below.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manual-through-ui">Manual through UI<a class="hash-link" aria-label="Direct link to Manual through UI" title="Direct link to Manual through UI" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#manual-through-ui">​</a></h2>
<p>As an admin, you can go to <a href="https://pp.cmd.ms/" target="_blank" rel="noopener noreferrer">Power Platform Admin</a> &gt; Environments &gt; Select Environment &gt; Under Resources &gt; Select Flows and you will be presented with all the flows in your environment. You can individually share or enable these flows using this screen.</p>
<p><img decoding="async" loading="lazy" alt="Power Platform Admin Flow List" src="https://m365tech.ca/assets/images/ppadm-flow-list-6b22b1213871c76730f252d3ab3ec417.jpg" width="1359" height="1036" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automate-using-powershell">Automate using PowerShell<a class="hash-link" aria-label="Direct link to Automate using PowerShell" title="Direct link to Automate using PowerShell" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#automate-using-powershell">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-modules">Install Modules<a class="hash-link" aria-label="Direct link to Install Modules" title="Direct link to Install Modules" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#install-modules">​</a></h3>
<p>You first need to install the required modules.</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Install-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Name AzureAD </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Scope CurrentUser</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Install-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Name Microsoft</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">PowerApps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">Administration</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">PowerShell </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Scope CurrentUser</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Install-Module</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Name Microsoft</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">PowerApps</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">PowerShell </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">Scope CurrentUser</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="script-composition">Script Composition<a class="hash-link" aria-label="Direct link to Script Composition" title="Direct link to Script Composition" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#script-composition">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="define-upn">Define UPN<a class="hash-link" aria-label="Direct link to Define UPN" title="Direct link to Define UPN" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#define-upn">​</a></h4>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Define User Principal Name of the new owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token plain"> = username@tenant</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="get-objectid-in-azure-ad">Get ObjectID in Azure AD<a class="hash-link" aria-label="Direct link to Get ObjectID in Azure AD" title="Direct link to Get ObjectID in Azure AD" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#get-objectid-in-azure-ad">​</a></h4>
<p>Login using the Power Platform Admin user account</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Get Object ID of new owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Connect-AzureAd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token variable" style="color:rgb(201, 103, 101)">$adUser</span><span class="token plain"> = </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Get-AzureAdUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">ObjectID </span><span class="token variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Select-Object</span><span class="token plain"> ObjectId</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="get-all-flows">Get All FLOWS<a class="hash-link" aria-label="Direct link to Get All FLOWS" title="Direct link to Get All FLOWS" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#get-all-flows">​</a></h4>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Get ALL flows accessible to Power Platform Admin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token variable" style="color:rgb(201, 103, 101)">$flows</span><span class="token plain"> = </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Get-AdminFlow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">f Magenta </span><span class="token string" style="color:rgb(72, 118, 214)">"</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">$</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">(</span><span class="token string function variable" style="color:rgb(201, 103, 101);font-style:italic">$flows</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">.</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">Count</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">)</span><span class="token string" style="color:rgb(72, 118, 214)"> flows accessible to current user"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="traverse-each-flow">Traverse each flow<a class="hash-link" aria-label="Direct link to Traverse each flow" title="Direct link to Traverse each flow" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#traverse-each-flow">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Each time we run a <strong>"Request sign off"</strong> in a SharePoint Library, a new flow is created in the environment (shown <a href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#manual-through-ui">above</a>). We don't need to change ownership of that flow hence we check the display name when we traverse.</p></div></div>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Traverse each flow and add new user as Owner for each</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(201, 103, 101)">$flows</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">DisplayName </span><span class="token operator" style="color:rgb(12, 150, 155)">-ne</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">"Request sign-off"</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">f Yellow </span><span class="token string" style="color:rgb(72, 118, 214)">"Adding user </span><span class="token string variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token string" style="color:rgb(72, 118, 214)"> to </span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">$</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">(</span><span class="token string function variable" style="color:rgb(201, 103, 101);font-style:italic">$flow</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">.</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">DisplayName</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">)</span><span class="token string" style="color:rgb(72, 118, 214)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Set-AdminFlowOwnerRole</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">EnvironmentName </span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">EnvironmentName `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">FlowName </span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">FlowName `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">RoleName CanEdit `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">PrincipalType User `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">PrincipalObjectId </span><span class="token variable" style="color:rgb(201, 103, 101)">$adUser</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ObjectId</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">f Green </span><span class="token string" style="color:rgb(72, 118, 214)">"Successfully added </span><span class="token string variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token string" style="color:rgb(72, 118, 214)"> to </span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">$</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">(</span><span class="token string function variable" style="color:rgb(201, 103, 101);font-style:italic">$flow</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">.</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">DisplayName</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">)</span><span class="token string" style="color:rgb(72, 118, 214)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="combining-everything">Combining everything<a class="hash-link" aria-label="Direct link to Combining everything" title="Direct link to Combining everything" href="https://m365tech.ca/bulk-change-the-owner-of-power-automate-flows-using-powershell#combining-everything">​</a></h3>
<p>Let's combine everything we have</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you are using solutions in your environment, you need to make the new owner a <strong>System Administrator for each environment</strong>. If not, the script will get an <strong>Error 403: Forbidden</strong>.</p></div></div>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#403f53;--prism-background-color:#FBFBFB"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#403f53"><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Define User Principal Name of the new owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token plain"> = username@tenant</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">com</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Get Object ID of new owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Connect-AzureAd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token variable" style="color:rgb(201, 103, 101)">$adUser</span><span class="token plain"> = </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Get-AzureAdUser</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">ObjectID </span><span class="token variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Select-Object</span><span class="token plain"> ObjectId</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Get ALL flows accessible to Power Platform Admin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token variable" style="color:rgb(201, 103, 101)">$flows</span><span class="token plain"> = </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Get-AdminFlow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">f Magenta </span><span class="token string" style="color:rgb(72, 118, 214)">"</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">$</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">(</span><span class="token string function variable" style="color:rgb(201, 103, 101);font-style:italic">$flows</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">.</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">Count</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">)</span><span class="token string" style="color:rgb(72, 118, 214)"> flows accessible to current user"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic">#Traverse each flow and add new user as Owner for each</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(201, 103, 101)">$flows</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">DisplayName </span><span class="token operator" style="color:rgb(12, 150, 155)">-ne</span><span class="token plain"> </span><span class="token string" style="color:rgb(72, 118, 214)">"Request sign-off"</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(153, 76, 195)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">f Yellow </span><span class="token string" style="color:rgb(72, 118, 214)">"Adding user </span><span class="token string variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token string" style="color:rgb(72, 118, 214)"> to </span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">$</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">(</span><span class="token string function variable" style="color:rgb(201, 103, 101);font-style:italic">$flow</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">.</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">DisplayName</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">)</span><span class="token string" style="color:rgb(72, 118, 214)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Set-AdminFlowOwnerRole</span><span class="token plain"> `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">EnvironmentName </span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">EnvironmentName `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">FlowName </span><span class="token variable" style="color:rgb(201, 103, 101)">$flow</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">FlowName `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">RoleName CanEdit `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">PrincipalType User `</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">            </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">PrincipalObjectId </span><span class="token variable" style="color:rgb(201, 103, 101)">$adUser</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">ObjectId</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token function" style="color:rgb(153, 76, 195);font-style:italic">Write-Host</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">-</span><span class="token plain">f Green </span><span class="token string" style="color:rgb(72, 118, 214)">"Successfully added </span><span class="token string variable" style="color:rgb(201, 103, 101)">$upn</span><span class="token string" style="color:rgb(72, 118, 214)"> to </span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">$</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">(</span><span class="token string function variable" style="color:rgb(201, 103, 101);font-style:italic">$flow</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">.</span><span class="token string function" style="color:rgb(153, 76, 195);font-style:italic">DisplayName</span><span class="token string function punctuation" style="color:rgb(153, 76, 195);font-style:italic">)</span><span class="token string" style="color:rgb(72, 118, 214)">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token punctuation" style="color:rgb(153, 76, 195)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Mark Doria</name>
            <uri>https://github.com/m365-tech</uri>
        </author>
        <category label="Power Automate" term="Power Automate"/>
        <category label="PowerShell" term="PowerShell"/>
    </entry>
</feed>